ROI_ct_plus_list<-c()
for (i in 1:length(ROIs_coef_ct_label)) {
ROI_ct_plus_list<-cat(ROI_ct_plus_list,paste0("\"lh_",ROIs_coef_ct_label[i],"\""),paste0(",\"rh_",ROIs_coef_ct_label[i],"\","))
print(ROI_ct_plus_list)
}
ROI_ct_plus_list<-c()
for (i in 1:length(ROIs_coef_ct_label)) {
ROI_ct_plus_list<-cat(paste(ROI_ct_plus_list,paste0("\"lh_",ROIs_coef_ct_label[i],"\""),paste0(",\"rh_",ROIs_coef_ct_label[i],"\",")))
}
ROI_ct_plus_list
ROIs_coef_ct_label
ROI_ct_plus_list<-c()
for (i in 1:length(ROIs_coef_ct_label)) {
ROI_ct_plus_list<-cat(ROI_ct_plus_list,paste0("\"lh_",ROIs_coef_ct_label[i],"\""),paste0(",\"rh_",ROIs_coef_ct_label[i],"\","))
}
ROIs_coef_ct_label
ROI_ct_plus_list<-as.list(ROIs_coef_ct_label)
ROI_ct_plus_list
ROIs_coef_ct_label <- na.omit(ROIs_coef_ct) %>%
mutate(label_ggseg=str_replace(label,"_ct",""))
ROI_ct_plus_list<-as.list(ROIs_coef_ct_label[,3])
ROI_ct_plus_list
ROI_ct_plus_list<-c()
for (i in 1:length(ROIs_coef_ct_label)) {
ROI_ct_plus_list[[i]]<-paste0("lh_",ROIs_coef_ct_label[i],"rh_",ROIs_coef_ct_label[i])
}
ROI_ct_plus_list
ROIs_coef_ct_label
ROI_ct_plus_list<-c()
for (i in 1:length(ROIs_coef_ct_label)) {
ROI_ct_plus_list[[i]]<-paste0("lh_",ROIs_coef_ct_label[i,3],"rh_",ROIs_coef_ct_label[i,3])
}
ROI_ct_plus_list
i
length(ROIs_coef_ct_label)
ROIs_coef_ct_label
length(ROIs_coef_ct_label[,3])
ROI_ct_plus_list<-c()
for (i in 1:length(ROIs_coef_ct_label[,3])) {
ROI_ct_plus_list[[i]]<-paste0(paste0("lh_",ROIs_coef_ct_label[i,3]),paste0("rh_",ROIs_coef_ct_label[i,3]))
}
ROI_ct_plus_list
ROI_ct_plus_list<-c()
for (i in 1:length(ROIs_coef_ct_label[,3])) {
ROI_ct_plus_list[[i]]<-cat(paste0("lh_",ROIs_coef_ct_label[i,3]),paste0("rh_",ROIs_coef_ct_label[i,3]))
}
ROI_ct_plus_list
ROI_ct_plus_list<-c()
for (i in 1:length(ROIs_coef_ct_label[,3])) {
ROI_ct_plus_list[[i]]<-paste0("lh_",ROIs_coef_ct_label[i,3],"\",\"rh_",ROIs_coef_ct_label[i,3])
}
ROI_ct_plus_list
ggplot(Regularization_CT_sum,aes(label,Times_survived_reg))+
geom_col()+
theme(axis.text.x = element_text(angle = 45, vjust = 1, hjust=1))+
ylim(0,100)
ggplot(Regularization_CT_sum,aes(reorder(label,-Times_survived_reg),Times_survived_reg))+
geom_col()+
theme(axis.text.x = element_text(angle = 45, vjust = 1, hjust=1))+
ylim(0,100)
Regularization_CT_sum
Regularization_CT_sum$lobe <- c("temporal","frontal","frontal","occipital","temporal","temporal","parietal","temporal","parietal","occipital","frontal","occipital","frontal","temporal","temporal","frontal","frontal","frontal","frontal","occipital","parietal","parietal","frontal","parietal","frontal","frontal","frontal","parietal","temporal","parietal","frontal","temporal","temporal","insula")
ggplot(Regularization_CT_sum,aes(reorder(label,-Times_survived_reg),Times_survived_reg,fill=lobe))+
geom_col()+
theme(axis.text.x = element_text(angle = 45, vjust = 1, hjust=1))+
ylim(0,100)
load("~/Projects/Project_physio_NG/Workspace_merge.RData")
#UPLOAD DATASETS
setwd("C:/Users/leamic/Documents/Projects/Project_physio_NG/Datasets")
data_artVIQ_fig1c<-read.csv(file="Dataset_Verbal.IQ_fig1c.csv", header=TRUE, sep=",", dec=".")
data_artVIQ_fig1d<-read.csv(file="Dataset_Verbal.IQ_fig1d.csv", header=TRUE, sep=",", dec=".")
data_artVIQ_fig1e<-read.csv(file="Dataset_Verbal.IQ_fig1e.csv", header=TRUE, sep=",", dec=".")
data_artVIQ_fig1f<-read.csv(file="Dataset_Verbal.IQ_fig1f.csv", header=TRUE, sep=",", dec=".")
data_artVIQ_fig2e<-read.csv(file="Dataset_Verbal.IQ_fig2e.csv", header=TRUE, sep=",", dec=".")
data_artVIQ_fig3a<-read.csv(file="Dataset_Verbal.IQ_fig3a.csv", header=TRUE, sep=",", dec=".")
data_artVIQ_fig3c<-read.csv(file="Dataset_Verbal.IQ_fig3c.csv", header=TRUE, sep=",", dec=".")
patient_numbers<-read.csv(file="Patient numbers_Lea.csv", header=TRUE, sep=",", dec=".")
patient_numbers<-patient_numbers[,c(1,2)]
data_NG<-read.csv(file="CortThick (lea).csv", header=TRUE, sep=",", dec=".")
key_id<-data_NG[,c(2,3)]
#UNIFROMIZE THE NAMES OF COLUMNS IN DATASETS
names(data_NG)[1]<- c("Slice_Name")
names(data_NG)[14]<- c("CorThickMRI_MTG")
names(data_NG)[38]<- c("TDLmM")
names(data_artVIQ_fig1c)[1:3]<- c("Subject","HemiRes","VIQ_highloss")
names(data_artVIQ_fig1d)[1]<- c("Subject")
names(data_artVIQ_fig1e)[1]<- c("Subject")
names(data_artVIQ_fig1f)<- c("Subject","C23Avg","CTotalAvg","CorThickMRI_MTG")
names(data_artVIQ_fig2e)<- c("Volgnummer","Slice_number","HemiRes","ResArea","Cell_area_um","Density_cells_mm3")
names(data_artVIQ_fig3a)<- c("Subject","Slice_Name","Cell.body.diameter","VIQ","HemiRes")
names(data_artVIQ_fig3c)[1]<- c("IDpk_Subject")
names(patient_numbers)<- c("Subject","Volgnummer")
data_artVIQ_fig1c[data_artVIQ_fig1c == "NaN"]<-NA
data_artVIQ_fig1d[data_artVIQ_fig1d == "NaN"]<-NA
data_artVIQ_fig1e[data_artVIQ_fig1e == "NaN"]<-NA
data_artVIQ_fig2e[data_artVIQ_fig2e == "NaN"]<-NA
data_artVIQ_fig3a[data_artVIQ_fig3a == "NaN"]<-NA
data_artVIQ_fig3c[data_artVIQ_fig3c == "NaN"]<-NA
#CLEAN DATASETS
data_artVIQ_fig3a <- data_artVIQ_fig3a %>%
mutate(HemiRes = case_when(
HemiRes == "NA" ~ as.character(NA),
HemiRes == "'right'" ~ "Right",
HemiRes == "'left'" ~ "Left"
))
data_artVIQ_fig2e <- data_artVIQ_fig2e %>%
mutate(HemiRes = case_when(
HemiRes == "[]" ~ as.character(NA),
HemiRes == "'Right'" ~ "Right",
HemiRes == "'Left'" ~ "Left"
)) %>% mutate(ResArea = case_when(
ResArea == "'Temporal'" ~ "temporal",
ResArea == "'temporal'" ~ "temporal",
ResArea == "'centroparietal'" ~ "centroparietal",
ResArea == "'frontal'" ~ "frontal"
))
data_NG<-data_NG %>%
mutate(TDLmM=TDLmM/1000)
data_NG <- data_NG %>% mutate_all(~ifelse(is.nan(.), NA, .))
data_NG_characteristics <- data_NG[,c("Subject","IDpk_Subject","HemiRes","gender","age","ResArea")]
data_NG_id <- data_NG[,c("Subject","IDpk_Subject")]
#Change the id for the data from fig 3a - removing a 0
data_artVIQ_fig3a<-data_artVIQ_fig3a %>%
mutate(Subject=paste(substr(Subject,1,2),substr(Subject,start=2,stop=4),sep=""))
#Change the slice_name for the data from fig 3a - replacing cell name with slice name
data_artVIQ_fig3a<-data_artVIQ_fig3a %>%
mutate(Cell_Name=Slice_Name) %>%
mutate(Slice_Name=substr(Slice_Name,1,nchar(Slice_Name)-3))
#Mergin the different id for fig 2e and 3c
data_artVIQ_fig2e <- merge(patient_numbers,data_artVIQ_fig2e,by=c("Volgnummer"))
data_artVIQ_fig3c<-merge(data_artVIQ_fig3c,data_NG_id,by=c("IDpk_Subject"))
#CREATE THE MEAN
#Cell area and density cells
mean_Cell_area_um <- data_artVIQ_fig2e %>%
group_by(Subject) %>%
summarise("mean_Cell_area_um" = mean(Cell_area_um, na.rm=TRUE))
mean_Density_cells_mm3 <- data_artVIQ_fig2e %>%
group_by(Subject) %>%
summarise("mean_Density_cells_mm3" = mean(Density_cells_mm3, na.rm=TRUE))
mean_Cell.body.diameter <- data_artVIQ_fig3a %>%
group_by(Subject) %>%
summarise("mean_Cell.body.diameter" = mean(Cell.body.diameter, na.rm=TRUE))
mean_TDLmM <- data_artVIQ_fig3c %>%
group_by(Subject) %>%
summarise("mean_TDLmM" = mean(TDLmM, na.rm=TRUE))
mean_BNBranches <- data_artVIQ_fig3c %>%
group_by(Subject) %>%
summarise("mean_BNBranches" = mean(BNBranches, na.rm=TRUE))
mean_CorThickMRI_MTG <- data_artVIQ_fig1f %>%
group_by(Subject) %>%
summarise("mean_CorThickMRI_MTG" = mean(CorThickMRI_MTG, na.rm=TRUE))
mean_test_MRI <- data.frame(Subject=c("H0001","H0003","H0004","H0005","H0008","H0009","H0010","H0011","H0012","H0013","H0029","H0030","H0031","H0032","H0033","H0034","H0035","H0037","H0042","H0046","H0049","H0050","H0051","H0052","H0053","H0054","H0057","H0058","H0060","H0061","H0069","H0070","H0071","H0073","H0074","H0077","H0081","H0084"),
MRI_CT=c("5","5","5","5","5","5","5","5","5","5","5","5","5","5","5","5","5","5","5","5","5","5","5","5","5","5","5","5","5","5","5","5","5","5","5","5","5","5"))
mean_Cell_area_um[mean_Cell_area_um == "NaN"]<-NA
mean_Density_cells_mm3[mean_Density_cells_mm3 == "NaN"]<-NA
mean_Cell.body.diameter[mean_Cell.body.diameter == "NaN"]<-NA
mean_TDLmM[mean_TDLmM == "NaN"]<-NA
mean_BNBranches[mean_BNBranches == "NaN"]<-NA
mean_CorThickMRI_MTG[mean_CorThickMRI_MTG == "NaN"]<-NA
#Merge the mean
data_means <- merge(mean_Cell_area_um,mean_Density_cells_mm3,by=c("Subject"),all=T)
data_means <- merge(data_means,mean_Cell.body.diameter,by=c("Subject"),all=T)
data_means <- merge(data_means,mean_TDLmM,by=c("Subject"),all=T)
data_means <- merge(data_means,mean_BNBranches,by=c("Subject"),all=T)
data_means <- merge(data_means,mean_CorThickMRI_MTG,by=c("Subject"),all=T)
data_means <- merge(data_means,mean_test_MRI,by=c("Subject"),all=T)
#Remove rows with only id
delete.na <- function(DF,n) {
print(DF[rowSums(is.na(DF))<n,])
}
data_means <- delete.na(data_means,7)
data_means_oldCT <- data_means[,c(1:7)]
#Remove rows with only id
data_means_oldCT <- delete.na(data_means_oldCT,6)
setwd("C:/Users/leamic/Documents/Projects/Project_physio_NG/Datasets")
data_artVIQ_fig1c<-read.csv(file="Dataset_Verbal.IQ_fig1c.csv", header=TRUE, sep=",", dec=".")
data_artVIQ_fig1d<-read.csv(file="Dataset_Verbal.IQ_fig1d.csv", header=TRUE, sep=",", dec=".")
data_artVIQ_fig1e<-read.csv(file="Dataset_Verbal.IQ_fig1e.csv", header=TRUE, sep=",", dec=".")
data_artVIQ_fig1f<-read.csv(file="Dataset_Verbal.IQ_fig1f.csv", header=TRUE, sep=",", dec=".")
data_artVIQ_fig2e<-read.csv(file="Dataset_Verbal.IQ_fig2e.csv", header=TRUE, sep=",", dec=".")
data_artVIQ_fig3a<-read.csv(file="Dataset_Verbal.IQ_fig3a.csv", header=TRUE, sep=",", dec=".")
data_artVIQ_fig3c<-read.csv(file="Dataset_Verbal.IQ_fig3c.csv", header=TRUE, sep=",", dec=".")
patient_numbers<-read.csv(file="Patient numbers_Lea.csv", header=TRUE, sep=",", dec=".")
patient_numbers<-patient_numbers[,c(1,2)]
data_NG<-read.csv(file="CortThick (lea).csv", header=TRUE, sep=",", dec=".")
key_id<-data_NG[,c(2,3)]
names(data_NG)[1]<- c("Slice_Name")
names(data_NG)[14]<- c("CorThickMRI_MTG")
names(data_NG)[38]<- c("TDLmM")
names(data_artVIQ_fig1c)[1:3]<- c("Subject","HemiRes","VIQ_highloss")
names(data_artVIQ_fig1d)[1]<- c("Subject")
names(data_artVIQ_fig1e)[1]<- c("Subject")
names(data_artVIQ_fig1f)<- c("Subject","C23Avg","CTotalAvg","CorThickMRI_MTG")
names(data_artVIQ_fig2e)<- c("Volgnummer","Slice_number","HemiRes","ResArea","Cell_area_um","Density_cells_mm3")
names(data_artVIQ_fig3a)<- c("Subject","Slice_Name","Cell.body.diameter","VIQ","HemiRes")
names(data_artVIQ_fig3c)[1]<- c("IDpk_Subject")
names(patient_numbers)<- c("Subject","Volgnummer")
data_artVIQ_fig1c[data_artVIQ_fig1c == "NaN"]<-NA
data_artVIQ_fig1d[data_artVIQ_fig1d == "NaN"]<-NA
data_artVIQ_fig1e[data_artVIQ_fig1e == "NaN"]<-NA
data_artVIQ_fig2e[data_artVIQ_fig2e == "NaN"]<-NA
data_artVIQ_fig3a[data_artVIQ_fig3a == "NaN"]<-NA
data_artVIQ_fig3c[data_artVIQ_fig3c == "NaN"]<-NA
data_artVIQ_fig3a <- data_artVIQ_fig3a %>%
mutate(HemiRes = case_when(
HemiRes == "NA" ~ as.character(NA),
HemiRes == "'right'" ~ "Right",
HemiRes == "'left'" ~ "Left"
))
data_artVIQ_fig2e <- data_artVIQ_fig2e %>%
mutate(HemiRes = case_when(
HemiRes == "[]" ~ as.character(NA),
HemiRes == "'Right'" ~ "Right",
HemiRes == "'Left'" ~ "Left"
)) %>% mutate(ResArea = case_when(
ResArea == "'Temporal'" ~ "temporal",
ResArea == "'temporal'" ~ "temporal",
ResArea == "'centroparietal'" ~ "centroparietal",
ResArea == "'frontal'" ~ "frontal"
))
library(dplyr)
library(lavaan)
data_artVIQ_fig3a <- data_artVIQ_fig3a %>%
mutate(HemiRes = case_when(
HemiRes == "NA" ~ as.character(NA),
HemiRes == "'right'" ~ "Right",
HemiRes == "'left'" ~ "Left"
))
data_artVIQ_fig2e <- data_artVIQ_fig2e %>%
mutate(HemiRes = case_when(
HemiRes == "[]" ~ as.character(NA),
HemiRes == "'Right'" ~ "Right",
HemiRes == "'Left'" ~ "Left"
)) %>% mutate(ResArea = case_when(
ResArea == "'Temporal'" ~ "temporal",
ResArea == "'temporal'" ~ "temporal",
ResArea == "'centroparietal'" ~ "centroparietal",
ResArea == "'frontal'" ~ "frontal"
))
data_NG<-data_NG %>%
mutate(TDLmM=TDLmM/1000)
data_NG <- data_NG %>% mutate_all(~ifelse(is.nan(.), NA, .))
data_NG_characteristics <- data_NG[,c("Subject","IDpk_Subject","HemiRes","gender","age","ResArea")]
data_NG_id <- data_NG[,c("Subject","IDpk_Subject")]
#Change the id for the data from fig 3a - removing a 0
data_artVIQ_fig3a<-data_artVIQ_fig3a %>%
mutate(Subject=paste(substr(Subject,1,2),substr(Subject,start=2,stop=4),sep=""))
#Change the slice_name for the data from fig 3a - replacing cell name with slice name
data_artVIQ_fig3a<-data_artVIQ_fig3a %>%
mutate(Cell_Name=Slice_Name) %>%
mutate(Slice_Name=substr(Slice_Name,1,nchar(Slice_Name)-3))
#Mergin the different id for fig 2e and 3c
data_artVIQ_fig2e <- merge(patient_numbers,data_artVIQ_fig2e,by=c("Volgnummer"))
data_artVIQ_fig3c<-merge(data_artVIQ_fig3c,data_NG_id,by=c("IDpk_Subject"))
#CREATE THE MEAN
#Cell area and density cells
mean_Cell_area_um <- data_artVIQ_fig2e %>%
group_by(Subject) %>%
summarise("mean_Cell_area_um" = mean(Cell_area_um, na.rm=TRUE))
mean_Density_cells_mm3 <- data_artVIQ_fig2e %>%
group_by(Subject) %>%
summarise("mean_Density_cells_mm3" = mean(Density_cells_mm3, na.rm=TRUE))
mean_Cell.body.diameter <- data_artVIQ_fig3a %>%
group_by(Subject) %>%
summarise("mean_Cell.body.diameter" = mean(Cell.body.diameter, na.rm=TRUE))
mean_TDLmM <- data_artVIQ_fig3c %>%
group_by(Subject) %>%
summarise("mean_TDLmM" = mean(TDLmM, na.rm=TRUE))
mean_BNBranches <- data_artVIQ_fig3c %>%
group_by(Subject) %>%
summarise("mean_BNBranches" = mean(BNBranches, na.rm=TRUE))
mean_CorThickMRI_MTG <- data_artVIQ_fig1f %>%
group_by(Subject) %>%
summarise("mean_CorThickMRI_MTG" = mean(CorThickMRI_MTG, na.rm=TRUE))
mean_test_MRI <- data.frame(Subject=c("H0001","H0003","H0004","H0005","H0008","H0009","H0010","H0011","H0012","H0013","H0029","H0030","H0031","H0032","H0033","H0034","H0035","H0037","H0042","H0046","H0049","H0050","H0051","H0052","H0053","H0054","H0057","H0058","H0060","H0061","H0069","H0070","H0071","H0073","H0074","H0077","H0081","H0084"),
MRI_CT=c("5","5","5","5","5","5","5","5","5","5","5","5","5","5","5","5","5","5","5","5","5","5","5","5","5","5","5","5","5","5","5","5","5","5","5","5","5","5"))
mean_Cell_area_um[mean_Cell_area_um == "NaN"]<-NA
mean_Density_cells_mm3[mean_Density_cells_mm3 == "NaN"]<-NA
mean_Cell.body.diameter[mean_Cell.body.diameter == "NaN"]<-NA
mean_TDLmM[mean_TDLmM == "NaN"]<-NA
mean_BNBranches[mean_BNBranches == "NaN"]<-NA
mean_CorThickMRI_MTG[mean_CorThickMRI_MTG == "NaN"]<-NA
#Merge the mean
data_means <- merge(mean_Cell_area_um,mean_Density_cells_mm3,by=c("Subject"),all=T)
data_means <- merge(data_means,mean_Cell.body.diameter,by=c("Subject"),all=T)
data_means <- merge(data_means,mean_TDLmM,by=c("Subject"),all=T)
data_means <- merge(data_means,mean_BNBranches,by=c("Subject"),all=T)
data_means <- merge(data_means,mean_CorThickMRI_MTG,by=c("Subject"),all=T)
data_means <- merge(data_means,mean_test_MRI,by=c("Subject"),all=T)
#Remove rows with only id
delete.na <- function(DF,n) {
print(DF[rowSums(is.na(DF))<n,])
}
data_means <- delete.na(data_means,7)
data_means_oldCT <- data_means[,c(1:7)]
#Remove rows with only id
data_means_oldCT <- delete.na(data_means_oldCT,6)
View(data_means)
write.csv(data_means,"data_5predCT.csv")
setwd("~/Projects/Project_physio_NG")
write.csv(data_means,'data_5predCT.csv',row.names=F)
load("~/Projects/Project 1/Data/Workspace_Modelfinal_reviewinprogress_HPC.RDataTmp")
load("~/Projects/Project 1/Data/Workspace_Modelfinal_reviewinprogress_HPC.RData")
------
library(lavaan)
library(tidymodels)
library(psych)
library(tidyr)
library(plyr)
library(dplyr)
library(udunits2)
library(ggseg)
library(ggseg3d)
library(ggsegJHU)
library(glmnet)
library(semTools)
library(ggplot2)
library(lavaanPlot)
library(ggplot2)
library(qpcR)
library(viridis)
library(knitr)
library(tidyverse)
metric.labs <- c("Fractional Anisotropy","Mean Diffusivity","White Matter Volume")
names(metric.labs) <- c("FA","MD","WMV")
ggplot(Regularization_WM_sum_plot,aes(label,Times_survived_reg,fill=fiber))+
geom_col(aes(alpha = 0.7))+
geom_col(data=Regularization_GMWM_WM_sum,aes(alpha = 0.7,colour="red"))+
facet_wrap(vars(metric),ncol=1,labeller=labeller(metric=metric.labs))+
theme_classic(base_size = 15)+
ylim(0,100)+
ylab('Times the regions survived\nregularization for the grey matter\nmodel including the three metrics') +
theme(axis.text.x = element_text(angle = 45, vjust = 1, hjust=1,size = rel(0.8)),axis.text.y = element_text(size = rel(0.9)),axis.title.y=element_text(size = rel(1.1)),axis.title.x=element_blank()) +
theme(
panel.background = element_rect(fill = "transparent"),
plot.background = element_rect(fill = "transparent", color = NA),
panel.grid.major.x = element_blank(),
panel.grid.minor.x = element_blank(),
panel.grid.major.y = element_line(colour = "grey80"),
panel.grid.minor.y = element_line(colour = "grey80")
)+
theme(panel.background = element_rect(fill = "white", colour = "grey50"))+
theme(strip.background = element_rect(colour = "grey90"),
strip.text.x = element_text(size = rel(1)))+
theme(legend.title = element_text(size=10,face="bold"))+
guides(fill=guide_legend("Fibers"),
colour=guide_legend(title="Adding the\nthree white\nmatter metrics",label=FALSE),
alpha="none")+
scale_fill_viridis(discrete=TRUE,begin=0.2,end=0.8,option="mako")
metric.labs <- c("Fractional Anisotropy","Mean Diffusivity","White Matter Volume")
names(metric.labs) <- c("FA","MD","WMV")
ggplot(Regularization_WM_sum_plot,aes(label,Times_survived_reg,fill=fiber))+
geom_col(aes(alpha = 0.7))+
geom_col(data=Regularization_GMWM_WM_sum,aes(alpha = 0.7,colour="red"))+
facet_wrap(vars(metric),ncol=1,labeller=labeller(metric=metric.labs))+
theme_classic(base_size = 15)+
ylim(0,100)+
ylab('Times the regions survived\nregularization for the white matter\nmodel including the three metrics') +
theme(axis.text.x = element_text(angle = 45, vjust = 1, hjust=1,size = rel(0.8)),axis.text.y = element_text(size = rel(0.9)),axis.title.y=element_text(size = rel(1.1)),axis.title.x=element_blank()) +
theme(
panel.background = element_rect(fill = "transparent"),
plot.background = element_rect(fill = "transparent", color = NA),
panel.grid.major.x = element_blank(),
panel.grid.minor.x = element_blank(),
panel.grid.major.y = element_line(colour = "grey80"),
panel.grid.minor.y = element_line(colour = "grey80")
)+
theme(panel.background = element_rect(fill = "white", colour = "grey50"))+
theme(strip.background = element_rect(colour = "grey90"),
strip.text.x = element_text(size = rel(1)))+
theme(legend.title = element_text(size=10,face="bold"))+
guides(fill=guide_legend("Fibers"),
colour=guide_legend(title="Adding the\nthree grey\nmatter metrics",label=FALSE),
alpha="none")+
scale_fill_viridis(discrete=TRUE,begin=0.2,end=0.8,option="mako")
ggsave("plot_survival_WM_GMWM.tiff", height=150, width=176, units='mm', dpi=600)
setwd("~/Projects/Project 1/Data")
ggsave("plot_survival_WM_GMWM.tiff", height=150, width=176, units='mm', dpi=600)
ggplot(Regularization_WM_sum_plot,aes(label,Times_survived_reg,fill=fiber))+
geom_col(aes(alpha = 0.7))+
geom_col(data=Regularization_GMWM_WM_sum,aes(alpha = 0.7,colour="red"))+
facet_wrap(vars(metric),ncol=1,labeller=labeller(metric=metric.labs))+
theme_classic(base_size = 15)+
ylim(0,100)+
ylab('Times the regions survived\nregularization for the white matter\nmodel including the three metrics') +
theme(axis.text.x = element_text(angle = 45, vjust = 1, hjust=1,size = rel(0.8)),axis.text.y = element_text(size = rel(0.9)),axis.title.y=element_text(size = rel(1.1)),axis.title.x=element_blank()) +
theme(
panel.background = element_rect(fill = "transparent"),
plot.background = element_rect(fill = "transparent", color = NA),
panel.grid.major.x = element_blank(),
panel.grid.minor.x = element_blank(),
panel.grid.major.y = element_line(colour = "grey80"),
panel.grid.minor.y = element_line(colour = "grey80")
)+
theme(panel.background = element_rect(fill = "white", colour = "grey50"))+
theme(strip.background = element_rect(colour = "grey90"),
strip.text.x = element_text(size = rel(1)))+
theme(legend.title = element_text(size=10,face="bold"))+
guides(fill=guide_legend("Fibers"),
colour=guide_legend(title="Adding the\nthree grey\nmatter metrics",label=FALSE),
alpha="none")+
scale_fill_viridis(discrete=TRUE,begin=0.2,end=0.8,option="mako")
load("~/Projects/Project 1/Data/Workspace_Modelfinal_reviewinprogress_HPC.RData")
library(lavaan)
library(tidymodels)
library(psych)
library(tidyr)
library(plyr)
library(dplyr)
library(udunits2)
library(ggseg)
library(ggseg3d)
library(ggsegJHU)
library(glmnet)
library(semTools)
library(ggplot2)
library(lavaanPlot)
library(ggplot2)
library(qpcR)
library(viridis)
library(knitr)
library(tidyverse)
ggplot(Regularization_GM_sum_plot,aes(label,Times_survived_reg,fill=lobe))+
geom_col()+
facet_wrap(vars(metric),ncol=1,labeller=labeller(metric=metric.labs))+
theme_classic(base_size = 15)+
ylim(0,100)+
ylab('Times the regions survived regularization\nfor the grey matter model including\nthe three metrics') +
theme(axis.text.x = element_text(angle = 45, vjust = 1, hjust=1,size = rel(0.7)),axis.text.y = element_text(size = rel(0.9)),axis.title.y=element_text(size = rel(1.1)),axis.title.x=element_blank()) +
theme(
panel.background = element_rect(fill = "transparent"),
plot.background = element_rect(fill = "transparent", color = NA),
panel.grid.major.x = element_blank(),
panel.grid.minor.x = element_blank(),
panel.grid.major.y = element_line(colour = "grey80"),
panel.grid.minor.y = element_line(colour = "grey80")
)+
theme(panel.background = element_rect(fill = "white", colour = "grey50"))+
theme(strip.background = element_rect(colour = "grey90"),
strip.text.x = element_text(size = rel(1)))+
theme(legend.title = element_text(size=10,face="bold"))+
guides(fill=guide_legend("Lobes"))+
scale_fill_viridis(discrete=TRUE,begin=0.2,end=0.8,option="magma")
metric.labs <- c("Cortical Thickness","Surface Area","Grey Matter Volume")
names(metric.labs) <- c("CT","SA","GMV")
ggplot(Regularization_GM_sum_plot,aes(label,Times_survived_reg,fill=lobe))+
geom_col()+
facet_wrap(vars(metric),ncol=1,labeller=labeller(metric=metric.labs))+
theme_classic(base_size = 15)+
ylim(0,100)+
ylab('Times the regions survived regularization\nfor the grey matter model including\nthe three metrics') +
theme(axis.text.x = element_text(angle = 45, vjust = 1, hjust=1,size = rel(0.7)),axis.text.y = element_text(size = rel(0.9)),axis.title.y=element_text(size = rel(1.1)),axis.title.x=element_blank()) +
theme(
panel.background = element_rect(fill = "transparent"),
plot.background = element_rect(fill = "transparent", color = NA),
panel.grid.major.x = element_blank(),
panel.grid.minor.x = element_blank(),
panel.grid.major.y = element_line(colour = "grey80"),
panel.grid.minor.y = element_line(colour = "grey80")
)+
theme(panel.background = element_rect(fill = "white", colour = "grey50"))+
theme(strip.background = element_rect(colour = "grey90"),
strip.text.x = element_text(size = rel(1)))+
theme(legend.title = element_text(size=10,face="bold"))+
guides(fill=guide_legend("Lobes"))+
scale_fill_viridis(discrete=TRUE,begin=0.2,end=0.8,option="magma")
metric.labs <- c("Fractional Anisotropy","Mean Diffusivity","White Matter Volume")
names(metric.labs) <- c("FA","MD","WMV")
ggplot(Regularization_WM_sum_plot,aes(label,Times_survived_reg,fill=fiber))+
geom_col()+
facet_wrap(vars(metric),ncol=1,labeller=labeller(metric=metric.labs))+
theme_classic(base_size = 15)+
ylim(0,100)+
ylab('Times the tracts survived regularization for\nthe white matter model including the three metrics') +
theme(axis.text.x = element_text(angle = 45, vjust = 1, hjust=1,size = rel(0.8)),axis.text.y = element_text(size = rel(0.8)),axis.title.y=element_text(size = rel(0.9)),axis.title.x=element_blank()) +
theme(
panel.background = element_rect(fill = NA),
panel.grid.major.x = element_blank(),
panel.grid.minor.x = element_blank(),
panel.grid.major.y = element_line(colour = "grey80"),
panel.grid.minor.y = element_line(colour = "grey80")
)+
theme(panel.background = element_rect(fill = "white", colour = "grey50"))+
theme(strip.background = element_rect(colour = "grey90"),
strip.text.x = element_text(size = rel(1)))+
theme(legend.title = element_text(size=10,face="bold"))+
guides(fill=guide_legend("Fibers"))+
scale_fill_viridis(discrete=TRUE,begin=0.2,end=0.8,option="mako")
ggplot(Regularization_WM_sum_plot,aes(label,Times_survived_reg,fill=fiber))+
geom_col()+
facet_wrap(vars(metric),ncol=1,labeller=labeller(metric=metric.labs))+
theme_classic(base_size = 15)+
ylim(0,100)+
ylab('Times the tracts survived regularization for\nthe white matter model including the three metrics') +
theme(axis.text.x = element_text(angle = 45, vjust = 1, hjust=1,size = rel(0.7)),axis.text.y = element_text(size = rel(0.9)),axis.title.y=element_text(size = rel(1.1)),axis.title.x=element_blank()) +
theme(
panel.background = element_rect(fill = "transparent"),
plot.background = element_rect(fill = "transparent", color = NA),
panel.grid.major.x = element_blank(),
panel.grid.minor.x = element_blank(),
panel.grid.major.y = element_line(colour = "grey80"),
panel.grid.minor.y = element_line(colour = "grey80")
)+
theme(panel.background = element_rect(fill = "white", colour = "grey50"))+
theme(strip.background = element_rect(colour = "grey90"),
strip.text.x = element_text(size = rel(1)))+
theme(legend.title = element_text(size=10,face="bold"))+
guides(fill=guide_legend("Fibers"))+
scale_fill_viridis(discrete=TRUE,begin=0.2,end=0.8,option="mako")
ggsave("plot_survival_WM.tiff", height=150, width=176, units='mm', dpi=600)
setwd("~/Projects/Project 1/Data")
ggsave("plot_survival_WM.tiff", height=150, width=176, units='mm', dpi=600)
