ROI_ct[1]
ROI_ct_plus_a
ROI_ct_plus_a<-c(ROI_ct[1])
for (i in 2:length(ROI_ct)) {
ROI_ct_plus_a<-paste(ROI_ct_plus_a,"+ a*",ROI_ct[i])
}
ROI_ct_plus_a
ROI_ct_plus_a<-c(ROI_ct[1])
for (i in 2:length(ROI_ct)) {
ROI_ct_plus_a<-paste("a*",ROI_ct_plus_a,"+ a*",ROI_ct[i])
}
ROI_ct_plus_a
ROI_ct_plus<-c(ROI_ct[1])    #Compute the regularized regions in a form easily inserted in the model
for (i in 2:length(ROI_ct)) {
ROI_ct_plus<-paste(ROI_ct_plus,"+",ROI_ct[i])
}
ROI_ct_plus_a<-c(ROI_ct[1])
for (i in 2:length(ROI_ct)) {
ROI_ct_plus_a<-paste(ROI_ct_plus_a,"+ a*",ROI_ct[i])
}
ROI_ct_plus
ROI_ct_plus_a
ggplot(Regularization_CT_sum,aes(label,Times_survived_reg))+
geom_col()+
theme(axis.text.x = element_text(angle = 45, vjust = 1, hjust=1))+
ylim(0,100) +
geom_hline(yintercept=75, linetype="dashed", color = "red")
ROIs_coef_ct
ROIs_coef_ct[,1]
ROIs_coef_ct_label <- ROIs_coef_ct %>%
mutate(label_ggseg=str_replace(label,"_ct",""))
library(tidyverse)
ROIs_coef_ct_label <- ROIs_coef_ct %>%
mutate(label_ggseg=str_replace(label,"_ct",""))
View(ROIs_coef_ct_label)
ROIs_coef_ct_label <- ROIs_coef_ct %>%
mutate(label_ggseg=str_replace(label,"_ct","")) %>%
mutate_each(label_ggseg=funs(paste("lh_", .)))
ROIs_coef_ct_label <- ROIs_coef_ct %>%
mutate(label_ggseg=str_replace(label,"_ct","")) %>%
mutate_each(label_ggseg=fun(paste("lh_", .)))
ROIs_coef_ct_label <- ROIs_coef_ct %>%
mutate(label_ggseg=str_replace(label,"_ct","")) %>%
mutate_each(label_ggseg=paste0("lh_",label_ggseg))
ROIs_coef_ct_label <- ROIs_coef_ct %>%
mutate(label_ggseg=str_replace(label,"_ct","")) %>%
mutate_each(label_ggseg=paste0("lh_",label_ggseg))
ROIs_coef_ct_label <- ROIs_coef_ct %>%
mutate(label_ggseg=str_replace(label,"_ct","")) %>%
mutate(label_ggseg=paste("lh_",label_ggseg))
ROIs_coef_ct_label <- ROIs_coef_ct %>%
mutate(label_ggseg=str_replace(label,"_ct","")) %>%
mutate(label_ggseg=paste0("lh_",label_ggseg))
ROI_ct
ROIs_coef_ct <- data.frame(label=c("bankssts_ct","caudalanteriorcingulate_ct","caudalmiddlefrontal_ct","cuneus_ct","entorhinal_ct","fusiform_ct","inferiorparietal_ct","inferiortemporal_ct","isthmuscingulate_ct","lateraloccipital_ct","lateralorbitofrontal_ct","lingual_ct","medialorbitofrontal_ct","middletemporal_ct","parahippocampal_ct","paracentral_ct","parsopercularis_ct","parsorbitalis_ct","parstriangularis_ct","pericalcarine_ct","postcentral_ct","posteriorcingulate_ct","precentral_ct","precuneus_ct","rostralanteriorcingulate_ct","rostralmiddlefrontal_ct","superiorfrontal_ct","superiorparietal_ct","superiortemporal_ct","supramarginal_ct","frontalpole_ct","temporalpole_ct","transversetemporal_ct","insula_ct"),
coef=rep(NA,times=34))
for (i in 1:nrow(new_coef_ct)) {
ROIs_coef_ct[new_coef_ct[i,1]-1,2] <- new_coef_ct[i,2]
}
ROI_ct<-c()
for (i in 1:34) {
if (ROIs_coef_ct[i,2] != NA) ROI_ct[i]<- ROIs_coef_ct[i,1]
}
lambdas <- 10^seq(3, -2, by = -.1)
df_ct <- data_total_subsample15[,c(10:43,172)]
df_ct <- makeX(df_ct, na.impute = TRUE)
x_ct <- df_ct[,1:34]
y_ct <- df_ct[,35]
cv_lasso_CTlat <- cv.glmnet(x_ct,y_ct, alpha = 1, lambda = lambdas, intercept = F, grouped=F)
plot(cv_lasso_CTlat)
new_coef_ct <- coef(cv_lasso_CTlat, s = "lambda.min")
new_coef_ct <- as.data.frame(summary(new_coef_ct))
new_coef_ct <- new_coef_ct[,c(1,3)]
names(new_coef_ct) <- c("index","coef")
ROIs_coef_ct <- data.frame(label=c("bankssts_ct","caudalanteriorcingulate_ct","caudalmiddlefrontal_ct","cuneus_ct","entorhinal_ct","fusiform_ct","inferiorparietal_ct","inferiortemporal_ct","isthmuscingulate_ct","lateraloccipital_ct","lateralorbitofrontal_ct","lingual_ct","medialorbitofrontal_ct","middletemporal_ct","parahippocampal_ct","paracentral_ct","parsopercularis_ct","parsorbitalis_ct","parstriangularis_ct","pericalcarine_ct","postcentral_ct","posteriorcingulate_ct","precentral_ct","precuneus_ct","rostralanteriorcingulate_ct","rostralmiddlefrontal_ct","superiorfrontal_ct","superiorparietal_ct","superiortemporal_ct","supramarginal_ct","frontalpole_ct","temporalpole_ct","transversetemporal_ct","insula_ct"),
coef=rep(NA,times=34))
for (i in 1:nrow(new_coef_ct)) {
ROIs_coef_ct[new_coef_ct[i,1]-1,2] <- new_coef_ct[i,2]
}
ROI_ct<-c()
for (i in 1:34) {
if (ROIs_coef_ct[i,2] != NA) ROI_ct[i]<- ROIs_coef_ct[i,1]
}
ROI_ct<-na.omit(ROI_ct)
for (i in 1:34) {
if (is.na(ROIs_coef_ct[i,2]) == FALSE) ROI_ct[i]<- ROIs_coef_ct[i,1]
}
ROI_ct<-na.omit(ROI_ct)
ROI_ct_plus<-c(ROI_ct[1])    #Compute the regularized regions in a form easily inserted in the model
for (i in 2:length(ROI_ct)) {
ROI_ct_plus<-paste(ROI_ct_plus,"+",ROI_ct[i])
}
ROI_ct_plus
ROIs_coef_ct
ROI_ct
new_coef_ct
ROIs_coef_ct
na.omit(ROIs_coef_ct)
ROIs_coef_ct_label <- na.omit(ROIs_coef_ct) %>%
mutate(label_ggseg=str_replace(label,"_ct","")) %>%
mutate(label_ggseg=paste0("lh_",label_ggseg))
ROI_ct_plus_list<-c(ROI_ct[1])
for (i in 2:length(ROI_ct)) {
ROI_ct_plus_list<-paste(ROI_ct_plus_list,", \"",ROI_ct[i],"\"")
}
ROI_ct_plus_list
ROI_ct_plus_list<-c(ROI_ct[1])
for (i in 2:length(ROI_ct)) {
ROI_ct_plus_list<-paste(ROI_ct_plus_list,", \" lh_",ROI_ct[i]," \"")
}
ROI_ct_plus_list
ROI_ct_plus_list<-c(ROI_ct[1])
for (i in 2:length(ROI_ct)) {
ROI_ct_plus_list<-paste(ROI_ct_plus_list,", \"lh_",ROI_ct[i]," \" ")
}
ROI_ct_plus_list
ROI_ct_plus_list<-c(ROI_ct[1])
for (i in 2:length(ROI_ct)) {
ROI_ct_plus_list<-paste(ROI_ct_plus_list,", /"lh_",ROI_ct[i]," /" ")
}
ROI_ct_plus_list<-c(ROI_ct[1])
for (i in 2:length(ROI_ct)) {
ROI_ct_plus_list<-paste(ROI_ct_plus_list,", \"lh_\"",ROI_ct[i]," \"\" ")
}
ROI_ct_plus_list
ROI_ct_plus_list<-c(ROI_ct[1])
for (i in 2:length(ROI_ct)) {
ROI_ct_plus_list<-paste0(ROI_ct_plus_list,", \"lh_",ROI_ct[i]," \" ")
}
ROI_ct_plus_list
x <- "say \"Hello!\""
x
cat(x)
ROI_ct_plus_list<-c(ROI_ct[1])
for (i in 2:length(ROI_ct)) {
ROI_ct_plus_list<-cat(ROI_ct_plus_list,", \"lh_",ROI_ct[i]," \" ")
}
ROI_ct_plus_list<-c(ROIs_coef_ct_label[1])
for (i in 2:length(ROIs_coef_ct_label)) {
ROI_ct_plus_list<-cat(ROI_ct_plus_list,", \"lh_",ROIs_coef_ct_label[i]," \" ")
}
ROIs_coef_ct_label
ROIs_coef_ct_label <- na.omit(ROIs_coef_ct) %>%
mutate(label_ggseg=str_replace(label,"_ct",""))
ROIs_coef_ct_label
ROIs_coef_ct_label<-ROIs_coef_ct_label[,3]
ROI_ct_plus_list<-c(ROIs_coef_ct_label[1])
for (i in 2:length(ROIs_coef_ct_label)) {
ROI_ct_plus_list<-cat(ROI_ct_plus_list,", \"lh_",ROIs_coef_ct_label[i]," \" ")
}
ROI_ct_plus_list<-c()
for (i in 1:length(ROIs_coef_ct_label)) {
ROI_ct_plus_list<-cat(ROI_ct_plus_list,", \"lh_",ROIs_coef_ct_label[i]," \" ",", \"rh_",ROIs_coef_ct_label[i]," \" ")
}
ROI_ct_plus_list<-c()
for (i in 1:length(ROIs_coef_ct_label)) {
ROI_ct_plus_list<-cat(ROI_ct_plus_list,"\"lh_",ROIs_coef_ct_label[i]," \" ",", \"rh_",ROIs_coef_ct_label[i]," \", ")
}
ROI_ct_plus_list<-c()
for (i in 1:length(ROIs_coef_ct_label)) {
ROI_ct_plus_list<-cat(ROI_ct_plus_list,paste0("\"lh_",ROIs_coef_ct_label[i]," \" "),paste0(", \"rh_",ROIs_coef_ct_label[i]," \", "))
}
ROI_ct_plus_list<-c()
for (i in 1:length(ROIs_coef_ct_label)) {
ROI_ct_plus_list<-cat(ROI_ct_plus_list,paste0("\"lh_",ROIs_coef_ct_label[i],"\""),paste0(",\"rh_",ROIs_coef_ct_label[i],"\","))
}
ROI_ct_plus_list<-c()
for (i in 1:length(ROIs_coef_ct_label)-1) {
ROI_ct_plus_list<-cat(ROI_ct_plus_list,paste0("\"lh_",ROIs_coef_ct_label[i],"\""),paste0(",\"rh_",ROIs_coef_ct_label[i],"\","))
}
ROI_ct_plus_list<-cat(ROI_ct_plus_list,paste0("\"lh_",ROIs_coef_ct_label[length(ROIs_coef_ct_label)],"\""),paste0(",\"rh_",ROIs_coef_ct_label[length(ROIs_coef_ct_label)],"\""))
length(ROIs_coef_ct_label)
ROI_ct_plus_list<-c()
for (i in 1:length(ROIs_coef_ct_label)-1) {
ROI_ct_plus_list<-cat(ROI_ct_plus_list,paste0("\"lh_",ROIs_coef_ct_label[i],"\""),paste0(",\"rh_",ROIs_coef_ct_label[i],"\","))
}
ROI_ct_plus_list<-cat(ROI_ct_plus_list,paste0("\"lh_",ROIs_coef_ct_label[22],"\""),paste0(",\"rh_",ROIs_coef_ct_label[22],"\""))
ROI_ct_plus_list<-c()
for (i in 1:length(ROIs_coef_ct_label)-1) {
ROI_ct_plus_list<-cat(ROI_ct_plus_list,paste0("\"lh_",ROIs_coef_ct_label[i],"\""),paste0(",\"rh_",ROIs_coef_ct_label[i],"\","))
}
ROI_ct_plus_list
ROI_ct_plus_list<-c()
for (i in 1:length(ROIs_coef_ct_label)-1) {
ROI_ct_plus_list<-cat(ROI_ct_plus_list,paste0("\"lh_",ROIs_coef_ct_label[i],"\""),paste0(",\"rh_",ROIs_coef_ct_label[i],"\","))
}
ROIs_coef_ct_label[1]
ROI_ct_plus_list<-c()
for (i in 1:length(ROIs_coef_ct_label)) {
ROI_ct_plus_list<-cat(ROI_ct_plus_list,paste0("\"lh_",ROIs_coef_ct_label[i],"\""),paste0(",\"rh_",ROIs_coef_ct_label[i],"\","))
}
ROI_ct_plus_list
cat(ROI_ct_plus_list,paste0("\"lh_",ROIs_coef_ct_label[i],"\""),paste0(",\"rh_",ROIs_coef_ct_label[i],"\","))
ROI_ct_plus_list<-c()
for (i in 1:length(ROIs_coef_ct_label)) {
ROI_ct_plus_list<-cat(ROI_ct_plus_list,paste0("\"lh_",ROIs_coef_ct_label[i],"\""),paste0(",\"rh_",ROIs_coef_ct_label[i],"\","))
}
ROI_ct_plus_list<-c()
for (i in 1:length(ROIs_coef_ct_label)) {
ROI_ct_plus_list<-print(cat(ROI_ct_plus_list,paste0("\"lh_",ROIs_coef_ct_label[i],"\""),paste0(",\"rh_",ROIs_coef_ct_label[i],"\",")))
}
ROI_ct_plus_list<-c()
for (i in 1:length(ROIs_coef_ct_label)) {
ROI_ct_plus_list<-paste0(cat(ROI_ct_plus_list,paste0("\"lh_",ROIs_coef_ct_label[i],"\""),paste0(",\"rh_",ROIs_coef_ct_label[i],"\",")))
}
ROI_ct_plus_list
ROI_ct_plus_list<-c()
for (i in 1:length(ROIs_coef_ct_label)) {
ROI_ct_plus_list<-paste0(ROI_ct_plus_list,paste0("\"lh_",ROIs_coef_ct_label[i],"\""),paste0(",\"rh_",ROIs_coef_ct_label[i],"\","))
}
ROI_ct_plus_list
ROI_ct_plus_list<-c()
for (i in 1:length(ROIs_coef_ct_label)) {
ROI_ct_plus_list<-cat(ROI_ct_plus_list,paste0("\"lh_",ROIs_coef_ct_label[i],"\""),paste0(",\"rh_",ROIs_coef_ct_label[i],"\","))
print(ROI_ct_plus_list)
}
ROI_ct_plus_list<-c()
for (i in 1:length(ROIs_coef_ct_label)) {
ROI_ct_plus_list<-cat(paste(ROI_ct_plus_list,paste0("\"lh_",ROIs_coef_ct_label[i],"\""),paste0(",\"rh_",ROIs_coef_ct_label[i],"\",")))
}
ROI_ct_plus_list
ROIs_coef_ct_label
ROI_ct_plus_list<-c()
for (i in 1:length(ROIs_coef_ct_label)) {
ROI_ct_plus_list<-cat(ROI_ct_plus_list,paste0("\"lh_",ROIs_coef_ct_label[i],"\""),paste0(",\"rh_",ROIs_coef_ct_label[i],"\","))
}
ROIs_coef_ct_label
ROI_ct_plus_list<-as.list(ROIs_coef_ct_label)
ROI_ct_plus_list
ROIs_coef_ct_label <- na.omit(ROIs_coef_ct) %>%
mutate(label_ggseg=str_replace(label,"_ct",""))
ROI_ct_plus_list<-as.list(ROIs_coef_ct_label[,3])
ROI_ct_plus_list
ROI_ct_plus_list<-c()
for (i in 1:length(ROIs_coef_ct_label)) {
ROI_ct_plus_list[[i]]<-paste0("lh_",ROIs_coef_ct_label[i],"rh_",ROIs_coef_ct_label[i])
}
ROI_ct_plus_list
ROIs_coef_ct_label
ROI_ct_plus_list<-c()
for (i in 1:length(ROIs_coef_ct_label)) {
ROI_ct_plus_list[[i]]<-paste0("lh_",ROIs_coef_ct_label[i,3],"rh_",ROIs_coef_ct_label[i,3])
}
ROI_ct_plus_list
i
length(ROIs_coef_ct_label)
ROIs_coef_ct_label
length(ROIs_coef_ct_label[,3])
ROI_ct_plus_list<-c()
for (i in 1:length(ROIs_coef_ct_label[,3])) {
ROI_ct_plus_list[[i]]<-paste0(paste0("lh_",ROIs_coef_ct_label[i,3]),paste0("rh_",ROIs_coef_ct_label[i,3]))
}
ROI_ct_plus_list
ROI_ct_plus_list<-c()
for (i in 1:length(ROIs_coef_ct_label[,3])) {
ROI_ct_plus_list[[i]]<-cat(paste0("lh_",ROIs_coef_ct_label[i,3]),paste0("rh_",ROIs_coef_ct_label[i,3]))
}
ROI_ct_plus_list
ROI_ct_plus_list<-c()
for (i in 1:length(ROIs_coef_ct_label[,3])) {
ROI_ct_plus_list[[i]]<-paste0("lh_",ROIs_coef_ct_label[i,3],"\",\"rh_",ROIs_coef_ct_label[i,3])
}
ROI_ct_plus_list
ggplot(Regularization_CT_sum,aes(label,Times_survived_reg))+
geom_col()+
theme(axis.text.x = element_text(angle = 45, vjust = 1, hjust=1))+
ylim(0,100)
ggplot(Regularization_CT_sum,aes(reorder(label,-Times_survived_reg),Times_survived_reg))+
geom_col()+
theme(axis.text.x = element_text(angle = 45, vjust = 1, hjust=1))+
ylim(0,100)
Regularization_CT_sum
Regularization_CT_sum$lobe <- c("temporal","frontal","frontal","occipital","temporal","temporal","parietal","temporal","parietal","occipital","frontal","occipital","frontal","temporal","temporal","frontal","frontal","frontal","frontal","occipital","parietal","parietal","frontal","parietal","frontal","frontal","frontal","parietal","temporal","parietal","frontal","temporal","temporal","insula")
ggplot(Regularization_CT_sum,aes(reorder(label,-Times_survived_reg),Times_survived_reg,fill=lobe))+
geom_col()+
theme(axis.text.x = element_text(angle = 45, vjust = 1, hjust=1))+
ylim(0,100)
load("~/Projects/Project_physio_NG/Workspace_merge.RData")
#UPLOAD DATASETS
setwd("C:/Users/leamic/Documents/Projects/Project_physio_NG/Datasets")
data_artVIQ_fig1c<-read.csv(file="Dataset_Verbal.IQ_fig1c.csv", header=TRUE, sep=",", dec=".")
data_artVIQ_fig1d<-read.csv(file="Dataset_Verbal.IQ_fig1d.csv", header=TRUE, sep=",", dec=".")
data_artVIQ_fig1e<-read.csv(file="Dataset_Verbal.IQ_fig1e.csv", header=TRUE, sep=",", dec=".")
data_artVIQ_fig1f<-read.csv(file="Dataset_Verbal.IQ_fig1f.csv", header=TRUE, sep=",", dec=".")
data_artVIQ_fig2e<-read.csv(file="Dataset_Verbal.IQ_fig2e.csv", header=TRUE, sep=",", dec=".")
data_artVIQ_fig3a<-read.csv(file="Dataset_Verbal.IQ_fig3a.csv", header=TRUE, sep=",", dec=".")
data_artVIQ_fig3c<-read.csv(file="Dataset_Verbal.IQ_fig3c.csv", header=TRUE, sep=",", dec=".")
patient_numbers<-read.csv(file="Patient numbers_Lea.csv", header=TRUE, sep=",", dec=".")
patient_numbers<-patient_numbers[,c(1,2)]
data_NG<-read.csv(file="CortThick (lea).csv", header=TRUE, sep=",", dec=".")
key_id<-data_NG[,c(2,3)]
#UNIFROMIZE THE NAMES OF COLUMNS IN DATASETS
names(data_NG)[1]<- c("Slice_Name")
names(data_NG)[14]<- c("CorThickMRI_MTG")
names(data_NG)[38]<- c("TDLmM")
names(data_artVIQ_fig1c)[1:3]<- c("Subject","HemiRes","VIQ_highloss")
names(data_artVIQ_fig1d)[1]<- c("Subject")
names(data_artVIQ_fig1e)[1]<- c("Subject")
names(data_artVIQ_fig1f)<- c("Subject","C23Avg","CTotalAvg","CorThickMRI_MTG")
names(data_artVIQ_fig2e)<- c("Volgnummer","Slice_number","HemiRes","ResArea","Cell_area_um","Density_cells_mm3")
names(data_artVIQ_fig3a)<- c("Subject","Slice_Name","Cell.body.diameter","VIQ","HemiRes")
names(data_artVIQ_fig3c)[1]<- c("IDpk_Subject")
names(patient_numbers)<- c("Subject","Volgnummer")
data_artVIQ_fig1c[data_artVIQ_fig1c == "NaN"]<-NA
data_artVIQ_fig1d[data_artVIQ_fig1d == "NaN"]<-NA
data_artVIQ_fig1e[data_artVIQ_fig1e == "NaN"]<-NA
data_artVIQ_fig2e[data_artVIQ_fig2e == "NaN"]<-NA
data_artVIQ_fig3a[data_artVIQ_fig3a == "NaN"]<-NA
data_artVIQ_fig3c[data_artVIQ_fig3c == "NaN"]<-NA
#CLEAN DATASETS
data_artVIQ_fig3a <- data_artVIQ_fig3a %>%
mutate(HemiRes = case_when(
HemiRes == "NA" ~ as.character(NA),
HemiRes == "'right'" ~ "Right",
HemiRes == "'left'" ~ "Left"
))
data_artVIQ_fig2e <- data_artVIQ_fig2e %>%
mutate(HemiRes = case_when(
HemiRes == "[]" ~ as.character(NA),
HemiRes == "'Right'" ~ "Right",
HemiRes == "'Left'" ~ "Left"
)) %>% mutate(ResArea = case_when(
ResArea == "'Temporal'" ~ "temporal",
ResArea == "'temporal'" ~ "temporal",
ResArea == "'centroparietal'" ~ "centroparietal",
ResArea == "'frontal'" ~ "frontal"
))
data_NG<-data_NG %>%
mutate(TDLmM=TDLmM/1000)
data_NG <- data_NG %>% mutate_all(~ifelse(is.nan(.), NA, .))
data_NG_characteristics <- data_NG[,c("Subject","IDpk_Subject","HemiRes","gender","age","ResArea")]
data_NG_id <- data_NG[,c("Subject","IDpk_Subject")]
#Change the id for the data from fig 3a - removing a 0
data_artVIQ_fig3a<-data_artVIQ_fig3a %>%
mutate(Subject=paste(substr(Subject,1,2),substr(Subject,start=2,stop=4),sep=""))
#Change the slice_name for the data from fig 3a - replacing cell name with slice name
data_artVIQ_fig3a<-data_artVIQ_fig3a %>%
mutate(Cell_Name=Slice_Name) %>%
mutate(Slice_Name=substr(Slice_Name,1,nchar(Slice_Name)-3))
#Mergin the different id for fig 2e and 3c
data_artVIQ_fig2e <- merge(patient_numbers,data_artVIQ_fig2e,by=c("Volgnummer"))
data_artVIQ_fig3c<-merge(data_artVIQ_fig3c,data_NG_id,by=c("IDpk_Subject"))
#CREATE THE MEAN
#Cell area and density cells
mean_Cell_area_um <- data_artVIQ_fig2e %>%
group_by(Subject) %>%
summarise("mean_Cell_area_um" = mean(Cell_area_um, na.rm=TRUE))
mean_Density_cells_mm3 <- data_artVIQ_fig2e %>%
group_by(Subject) %>%
summarise("mean_Density_cells_mm3" = mean(Density_cells_mm3, na.rm=TRUE))
mean_Cell.body.diameter <- data_artVIQ_fig3a %>%
group_by(Subject) %>%
summarise("mean_Cell.body.diameter" = mean(Cell.body.diameter, na.rm=TRUE))
mean_TDLmM <- data_artVIQ_fig3c %>%
group_by(Subject) %>%
summarise("mean_TDLmM" = mean(TDLmM, na.rm=TRUE))
mean_BNBranches <- data_artVIQ_fig3c %>%
group_by(Subject) %>%
summarise("mean_BNBranches" = mean(BNBranches, na.rm=TRUE))
mean_CorThickMRI_MTG <- data_artVIQ_fig1f %>%
group_by(Subject) %>%
summarise("mean_CorThickMRI_MTG" = mean(CorThickMRI_MTG, na.rm=TRUE))
mean_test_MRI <- data.frame(Subject=c("H0001","H0003","H0004","H0005","H0008","H0009","H0010","H0011","H0012","H0013","H0029","H0030","H0031","H0032","H0033","H0034","H0035","H0037","H0042","H0046","H0049","H0050","H0051","H0052","H0053","H0054","H0057","H0058","H0060","H0061","H0069","H0070","H0071","H0073","H0074","H0077","H0081","H0084"),
MRI_CT=c("5","5","5","5","5","5","5","5","5","5","5","5","5","5","5","5","5","5","5","5","5","5","5","5","5","5","5","5","5","5","5","5","5","5","5","5","5","5"))
mean_Cell_area_um[mean_Cell_area_um == "NaN"]<-NA
mean_Density_cells_mm3[mean_Density_cells_mm3 == "NaN"]<-NA
mean_Cell.body.diameter[mean_Cell.body.diameter == "NaN"]<-NA
mean_TDLmM[mean_TDLmM == "NaN"]<-NA
mean_BNBranches[mean_BNBranches == "NaN"]<-NA
mean_CorThickMRI_MTG[mean_CorThickMRI_MTG == "NaN"]<-NA
#Merge the mean
data_means <- merge(mean_Cell_area_um,mean_Density_cells_mm3,by=c("Subject"),all=T)
data_means <- merge(data_means,mean_Cell.body.diameter,by=c("Subject"),all=T)
data_means <- merge(data_means,mean_TDLmM,by=c("Subject"),all=T)
data_means <- merge(data_means,mean_BNBranches,by=c("Subject"),all=T)
data_means <- merge(data_means,mean_CorThickMRI_MTG,by=c("Subject"),all=T)
data_means <- merge(data_means,mean_test_MRI,by=c("Subject"),all=T)
#Remove rows with only id
delete.na <- function(DF,n) {
print(DF[rowSums(is.na(DF))<n,])
}
data_means <- delete.na(data_means,7)
data_means_oldCT <- data_means[,c(1:7)]
#Remove rows with only id
data_means_oldCT <- delete.na(data_means_oldCT,6)
setwd("C:/Users/leamic/Documents/Projects/Project_physio_NG/Datasets")
data_artVIQ_fig1c<-read.csv(file="Dataset_Verbal.IQ_fig1c.csv", header=TRUE, sep=",", dec=".")
data_artVIQ_fig1d<-read.csv(file="Dataset_Verbal.IQ_fig1d.csv", header=TRUE, sep=",", dec=".")
data_artVIQ_fig1e<-read.csv(file="Dataset_Verbal.IQ_fig1e.csv", header=TRUE, sep=",", dec=".")
data_artVIQ_fig1f<-read.csv(file="Dataset_Verbal.IQ_fig1f.csv", header=TRUE, sep=",", dec=".")
data_artVIQ_fig2e<-read.csv(file="Dataset_Verbal.IQ_fig2e.csv", header=TRUE, sep=",", dec=".")
data_artVIQ_fig3a<-read.csv(file="Dataset_Verbal.IQ_fig3a.csv", header=TRUE, sep=",", dec=".")
data_artVIQ_fig3c<-read.csv(file="Dataset_Verbal.IQ_fig3c.csv", header=TRUE, sep=",", dec=".")
patient_numbers<-read.csv(file="Patient numbers_Lea.csv", header=TRUE, sep=",", dec=".")
patient_numbers<-patient_numbers[,c(1,2)]
data_NG<-read.csv(file="CortThick (lea).csv", header=TRUE, sep=",", dec=".")
key_id<-data_NG[,c(2,3)]
names(data_NG)[1]<- c("Slice_Name")
names(data_NG)[14]<- c("CorThickMRI_MTG")
names(data_NG)[38]<- c("TDLmM")
names(data_artVIQ_fig1c)[1:3]<- c("Subject","HemiRes","VIQ_highloss")
names(data_artVIQ_fig1d)[1]<- c("Subject")
names(data_artVIQ_fig1e)[1]<- c("Subject")
names(data_artVIQ_fig1f)<- c("Subject","C23Avg","CTotalAvg","CorThickMRI_MTG")
names(data_artVIQ_fig2e)<- c("Volgnummer","Slice_number","HemiRes","ResArea","Cell_area_um","Density_cells_mm3")
names(data_artVIQ_fig3a)<- c("Subject","Slice_Name","Cell.body.diameter","VIQ","HemiRes")
names(data_artVIQ_fig3c)[1]<- c("IDpk_Subject")
names(patient_numbers)<- c("Subject","Volgnummer")
data_artVIQ_fig1c[data_artVIQ_fig1c == "NaN"]<-NA
data_artVIQ_fig1d[data_artVIQ_fig1d == "NaN"]<-NA
data_artVIQ_fig1e[data_artVIQ_fig1e == "NaN"]<-NA
data_artVIQ_fig2e[data_artVIQ_fig2e == "NaN"]<-NA
data_artVIQ_fig3a[data_artVIQ_fig3a == "NaN"]<-NA
data_artVIQ_fig3c[data_artVIQ_fig3c == "NaN"]<-NA
data_artVIQ_fig3a <- data_artVIQ_fig3a %>%
mutate(HemiRes = case_when(
HemiRes == "NA" ~ as.character(NA),
HemiRes == "'right'" ~ "Right",
HemiRes == "'left'" ~ "Left"
))
data_artVIQ_fig2e <- data_artVIQ_fig2e %>%
mutate(HemiRes = case_when(
HemiRes == "[]" ~ as.character(NA),
HemiRes == "'Right'" ~ "Right",
HemiRes == "'Left'" ~ "Left"
)) %>% mutate(ResArea = case_when(
ResArea == "'Temporal'" ~ "temporal",
ResArea == "'temporal'" ~ "temporal",
ResArea == "'centroparietal'" ~ "centroparietal",
ResArea == "'frontal'" ~ "frontal"
))
library(dplyr)
library(lavaan)
data_artVIQ_fig3a <- data_artVIQ_fig3a %>%
mutate(HemiRes = case_when(
HemiRes == "NA" ~ as.character(NA),
HemiRes == "'right'" ~ "Right",
HemiRes == "'left'" ~ "Left"
))
data_artVIQ_fig2e <- data_artVIQ_fig2e %>%
mutate(HemiRes = case_when(
HemiRes == "[]" ~ as.character(NA),
HemiRes == "'Right'" ~ "Right",
HemiRes == "'Left'" ~ "Left"
)) %>% mutate(ResArea = case_when(
ResArea == "'Temporal'" ~ "temporal",
ResArea == "'temporal'" ~ "temporal",
ResArea == "'centroparietal'" ~ "centroparietal",
ResArea == "'frontal'" ~ "frontal"
))
data_NG<-data_NG %>%
mutate(TDLmM=TDLmM/1000)
data_NG <- data_NG %>% mutate_all(~ifelse(is.nan(.), NA, .))
data_NG_characteristics <- data_NG[,c("Subject","IDpk_Subject","HemiRes","gender","age","ResArea")]
data_NG_id <- data_NG[,c("Subject","IDpk_Subject")]
#Change the id for the data from fig 3a - removing a 0
data_artVIQ_fig3a<-data_artVIQ_fig3a %>%
mutate(Subject=paste(substr(Subject,1,2),substr(Subject,start=2,stop=4),sep=""))
#Change the slice_name for the data from fig 3a - replacing cell name with slice name
data_artVIQ_fig3a<-data_artVIQ_fig3a %>%
mutate(Cell_Name=Slice_Name) %>%
mutate(Slice_Name=substr(Slice_Name,1,nchar(Slice_Name)-3))
#Mergin the different id for fig 2e and 3c
data_artVIQ_fig2e <- merge(patient_numbers,data_artVIQ_fig2e,by=c("Volgnummer"))
data_artVIQ_fig3c<-merge(data_artVIQ_fig3c,data_NG_id,by=c("IDpk_Subject"))
#CREATE THE MEAN
#Cell area and density cells
mean_Cell_area_um <- data_artVIQ_fig2e %>%
group_by(Subject) %>%
summarise("mean_Cell_area_um" = mean(Cell_area_um, na.rm=TRUE))
mean_Density_cells_mm3 <- data_artVIQ_fig2e %>%
group_by(Subject) %>%
summarise("mean_Density_cells_mm3" = mean(Density_cells_mm3, na.rm=TRUE))
mean_Cell.body.diameter <- data_artVIQ_fig3a %>%
group_by(Subject) %>%
summarise("mean_Cell.body.diameter" = mean(Cell.body.diameter, na.rm=TRUE))
mean_TDLmM <- data_artVIQ_fig3c %>%
group_by(Subject) %>%
summarise("mean_TDLmM" = mean(TDLmM, na.rm=TRUE))
mean_BNBranches <- data_artVIQ_fig3c %>%
group_by(Subject) %>%
summarise("mean_BNBranches" = mean(BNBranches, na.rm=TRUE))
mean_CorThickMRI_MTG <- data_artVIQ_fig1f %>%
group_by(Subject) %>%
summarise("mean_CorThickMRI_MTG" = mean(CorThickMRI_MTG, na.rm=TRUE))
mean_test_MRI <- data.frame(Subject=c("H0001","H0003","H0004","H0005","H0008","H0009","H0010","H0011","H0012","H0013","H0029","H0030","H0031","H0032","H0033","H0034","H0035","H0037","H0042","H0046","H0049","H0050","H0051","H0052","H0053","H0054","H0057","H0058","H0060","H0061","H0069","H0070","H0071","H0073","H0074","H0077","H0081","H0084"),
MRI_CT=c("5","5","5","5","5","5","5","5","5","5","5","5","5","5","5","5","5","5","5","5","5","5","5","5","5","5","5","5","5","5","5","5","5","5","5","5","5","5"))
mean_Cell_area_um[mean_Cell_area_um == "NaN"]<-NA
mean_Density_cells_mm3[mean_Density_cells_mm3 == "NaN"]<-NA
mean_Cell.body.diameter[mean_Cell.body.diameter == "NaN"]<-NA
mean_TDLmM[mean_TDLmM == "NaN"]<-NA
mean_BNBranches[mean_BNBranches == "NaN"]<-NA
mean_CorThickMRI_MTG[mean_CorThickMRI_MTG == "NaN"]<-NA
#Merge the mean
data_means <- merge(mean_Cell_area_um,mean_Density_cells_mm3,by=c("Subject"),all=T)
data_means <- merge(data_means,mean_Cell.body.diameter,by=c("Subject"),all=T)
data_means <- merge(data_means,mean_TDLmM,by=c("Subject"),all=T)
data_means <- merge(data_means,mean_BNBranches,by=c("Subject"),all=T)
data_means <- merge(data_means,mean_CorThickMRI_MTG,by=c("Subject"),all=T)
data_means <- merge(data_means,mean_test_MRI,by=c("Subject"),all=T)
#Remove rows with only id
delete.na <- function(DF,n) {
print(DF[rowSums(is.na(DF))<n,])
}
data_means <- delete.na(data_means,7)
data_means_oldCT <- data_means[,c(1:7)]
#Remove rows with only id
data_means_oldCT <- delete.na(data_means_oldCT,6)
View(data_means)
write.csv(data_means,"data_5predCT.csv")
setwd("~/Projects/Project_physio_NG")
write.csv(data_means,'data_5predCT.csv',row.names=F)
